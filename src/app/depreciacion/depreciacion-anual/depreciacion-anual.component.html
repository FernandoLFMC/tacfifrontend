<div class="titulo">
    <h2 *ngIf="fecha">Depreciacion Anual a fecha 31-12-{{fechacalcular.year}}</h2>
</div>
<div class="title">
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <mat-form-field>
        <mat-label>Choose a date</mat-label>
        <input matInput [matDatepicker]="picker" [(ngModel)]="date">
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    <button (click)="calculoDepre(dataSources.data)" mat-raised-button color="primary">Ejecutar</button>
    <button (click)="exportExcel()" mat-raised-button color="primary">exportar excel</button>
    &nbsp;&nbsp;&nbsp;
    <button  mat-raised-button color="primary" (click)="exportPDF()" >Exportar Depreciacion PDF
        <mat-icon>trending_down</mat-icon>
    </button>
</div>
<div class="row">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z7">

        <ng-container matColumnDef="codigo">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Codigo&nbsp;&nbsp;&nbsp;</th>
        <td mat-cell *matCellDef="let row"> {{row.codigo}}</td>
        </ng-container>

        <ng-container matColumnDef="area">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Area&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.area}}</td>
        </ng-container>

        <ng-container matColumnDef="nombre_tipo">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nomb. tipo&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.nombre_tipo}} </td>
        </ng-container>
        
        <ng-container matColumnDef="descripcion">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Descripcion &nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.descripcion}} </td>
        </ng-container>
    
        <ng-container matColumnDef="vida_util">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Vida util meses &nbsp;&nbsp;&nbsp;</th>
        <td mat-cell *matCellDef="let row"> {{row.vida_util}} </td>
        </ng-container>

        <ng-container matColumnDef="sujeto_depreciacion">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Sujeto Depreciacion &nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.sujeto_depreciacion}} </td>
            </ng-container>

        <ng-container matColumnDef="fecha_adqui">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha Adquicicion&nbsp;&nbsp;&nbsp;</th>
        <td mat-cell *matCellDef="let row"> {{row.fecha_adqui}} </td>
        </ng-container>

        <ng-container matColumnDef="fecha_inicio">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha de inicio &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.fecha_inicio}} </td>
        </ng-container>


        <ng-container matColumnDef="fecha_vencimiento">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha vencimiento&nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.fecha_vencimiento}} </td>
        </ng-container>

        <ng-container matColumnDef="meses_transcurridos">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Meses trans..&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.meses_transcurridos}} </td>
        </ng-container>

        <ng-container matColumnDef="meses_faltantes">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Meses Falt.. &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.meses_faltantes}} </td>
        </ng-container>

        <ng-container matColumnDef="precio_inicial">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio Adqui.. &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.precio_inicial}} </td>
        </ng-container>
    
        <ng-container matColumnDef="valor_anterior">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Valor Ant.. &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.valor_anterior}} </td>
        </ng-container>

        <ng-container matColumnDef="depreciacion_mensual">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Depreciacion mensual &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.depreciacion_mensual}} </td>
        </ng-container>

        <ng-container matColumnDef="gasto_al">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Gasto al 31-12-{{fechacalcular.year}} &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.gasto_al}} </td>
        </ng-container>

        <ng-container matColumnDef="valor_acumulado">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Valor Acumulado 31-12-{{fechacalcular.year}} &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.valor_acumulado}} </td>
        </ng-container>

        <ng-container matColumnDef="valor_neto">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Valor Neto &nbsp;&nbsp;&nbsp;&nbsp;</th>
            <td mat-cell *matCellDef="let row"> {{row.valor_neto}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons class="mat-elevation-z7"></mat-paginator>
</div>